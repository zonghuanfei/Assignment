# 3.1.1平滑轨迹 
时间的标量函数：初始值和最终值是确定的，函数是光滑的（低阶导数是连续的），常用的是五次多项式。  

```
s=tpoly(0,1,50);

plot(s)

[s , sd , sdd]=tpoly(0,1,50);

s=tpoly(0,1,50,0.5,0);%初始速度0.5，最终速度是0
```
多项式函数的问题在于平均速度小，为了尽可能让机器人在最大速度运动，可以采用混合轨迹
```s=lspb(0,1,50);```
速度值不可任意选择，过大过小都会函数返回错误。

# 3.1.2多维的情况  
```x= mtraj(@tpoly,[0 2],[1 -1],50);%得到一个50乘2的矩阵，每一行是一个时间步，每一列是一个轴```
# 3.1.3多段轨迹
轨迹中有中间点，但不能在中间点停留，为了实现速度连续，只能舍弃到达中间点，在中间点处使用混合轨迹衔接。  
混合时间：以混合轨迹运行花费的时间。若已知最大加速能力就可以求出最小混合时间。  
mstraj函数可以生成多段多轴轨迹
```
>> via = [ 4,1;4,4; 5,2;2,5 ];

>>q = mstraj(via,[2,1],[]，[4,1],0.05,0 );%v函数mstraj的第一个参数是中间点矩阵，每点对应矩阵的一行。
剩余的参数分别是:每轴的最大速度向量,每段的运动时间向量,起点各轴坐标，采样时间间隔,以及加速时间。
```
函数mstraj返回一个矩阵,行对应的是时间每步，列对应的是各个轴。
# 3.1.4三维空间姿态插值
如果位姿由正交旋转矩阵表示,ξ~R∈SO(3)，可以考虑用简单的线性插值σ(R0，R1, s )=( 1 -s )R0+ sR1,。但这是不可行的，这样插值后得到的通常不再是有效的正交矩阵，因为正交矩阵必须满足的列向量范数为1以及列向量之间正交的条件。  
插入第三章3  
## 三角度表示法
```
>>R0= rotz(-1)* roty(-1);
>>R1= rotz( 1) * roty （1); %定义两个姿态
>>rpy0 =tr2rpy(R0);  
  rpy1 =tr2rpy (R1);% 得到等价横滚-俯仰-偏航角:
  然后分50个时间步在它们之间生成一条轨迹:
>>rpy =mtraj(@tpoly, rpy0,rpy1,50 ) ;
通过动画演示,观察轨迹变化过程:
>>tranimate( rpy2tr(rpy));
```
## 单位四元数插值法  
q0= Quaternion (R0);
q1 = Quaternion(R1);
q = interp(q0,q1,[0: 49]'/49);
得到一个有五十个四元数对象的向量  
# 3.1.5笛卡尔运动  
rpy是一个50×3矩阵，而rpy2tr的结果是3.1.5节中提过的4×4×50矩阵。
我们将初始和最终位姿都表示成齐次变换矩阵:
```>>T0= transl(0.4,0.2,0* trotx(pi);
>>T1 = transl(-0.4，-0.2，0.3) * troty(pi/2) *trotz(-pi/2 ) ;
工具箱函数trinterp提供了沿路径单位化距离s ∈[0,1]中的位姿插值。例如，其中间的位姿是
插入第三章4  
`Ts = trinterp(T0,T1,[0:49]/49）；`
得到平移部分
```
P=transl(Ts)；```
plot(p)可求位置向量，结果如下图
可求三角度姿态变化曲线
```
rpy=tr2rpy(Ts);
plot ( rpy );
```

然而，平移运动在第一个和最后一个点上的速度和加速度是不连续的。问题在于虽然轨迹在空间中是平滑的，但沿轨迹的步距s在时间上并不平滑。路径起点上的速度值从零跳跃到有限值，然后在终点又突降至零——没有相应的起始加速和结束减速。我们可以用前面讨论过的标量函数tpoly和 lspb来创建一个时间上平滑的s，这样沿路径的运动也平滑了。我们只需将传递给trinterp的第三个参数更改为一个沿路径的单位化距离向量，如lspb(0,1,50)

# 3.2时变坐标系  

# 3.2.1旋转坐标系  

# 3.2.2增量转动  

# 3.2.3惯性导航系统  
